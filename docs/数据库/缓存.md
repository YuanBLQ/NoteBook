# 缓存常见问题

围绕缓存，最常见的三个问题：

- 缓存雪崩
- 缓存穿透
- 缓存击穿

这三个名词说出来很容易，但是要讲清楚就没那么简单了。

## 缓存雪崩

简单一句话：某一时间点，大量缓存失效，导致数据库请求激增，把数据库爆掉。

解决方案：

- 缓存失效时间加上一个随机值
- redis集群部署，将热点数据分布在不同redis库

## 缓存击穿

和上面的缓存雪崩很类似，不同的是，雪崩是大面积缓存失效，而击穿则是某一个热点 key 在高并发场景下突然失效，导致数据库被无情捶打。

解决方案：

- 加个互斥锁，缓存失效的时候只能有一个请求去请求数据库数据

## 缓存穿透

某个请求去查一个不存在的数据时，缓存不知道就自然走到了数据库，但是数据库也查不到，最终也没有任何数据写回缓存。

这就有意思了，如果这种查询操作大规模进来都会实打实的穿透缓存直击数据库。

解决方案：

- 数据查不到的时候写一个空值给缓存（当然要加个过期时间）
- 前置布隆过滤器，没有的直接返回