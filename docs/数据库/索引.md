# 索引

## MySQL

### 聚簇索引 & 非聚簇索引

一句话：叶子节点是否存放一整行记录。

**聚簇索引**，表数据和索引是存放在一起的。主键索引的叶子节点存储行数据（包含主键值），二级索引的叶子节点存储的是主键值（为了减少当出现行移动或数据页分裂时二级索引的维护工作，但会占用更多的空间）。

**非聚簇索引**，表数据和索引分开存放。主键索引和二级索引存储上没有关系。叶子节点存储的是对应索引对应记录的数据。

### 聚簇索引的优点

1. 获取一定范围内的数据时，比非聚簇索引方便
2. 查找数据理论上比非聚簇索引快，因为非聚簇索引定位到对应主键是还要多一次目标地址寻址，即多一次IO

### 聚簇索引的缺点

1. 插入速度依赖插入的顺序，按照主键的顺序插入最快，否则会出现页分裂，严重影响性能。一般主键定义为自增ID
2. 主键的更新代价很高，因为主键更新伴随着主键顺序的变化，会导致数据行移动
3. 二级索引访问需要访问两次索引查找，第一次找到主键值，第二次根据主键值找到行数据

